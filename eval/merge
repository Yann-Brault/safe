#!/bin/sh

for i in "$@"
do
case $i in
  -w|--wrapped)
    WRAPPED=true
    shift
  ;;
  -*)
    shift
  ;;
esac
done

TARGET="target.js"

LODASH=$SAFE_HOME/tests/benchmarks/lodash4

echo > $TARGET
if [ $WRAPPED ]; then
  echo "(function() {" >> $TARGET
fi

cat $LODASH/setting.js $LODASH/lodash.js $LODASH/test-setting.js >> $TARGET
if [ "$#" -eq 1 ]; then
  cat $@ >> $TARGET
fi

if [ $WRAPPED ]; then
  echo "}.call(global));" >> $TARGET
fi
node $DS_HOME/parenthesize.js $TARGET $TARGET
